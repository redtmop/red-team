All recon will be done with `PowerView` . 

Covenant command is `powershell-import` and Cobalt strike `PowerSploit>Recon>PowerView.ps1`. 

Serially i will note some PowerView command to recon the domain


### Get-Domain

Returns a Domain object for the current domain or the domain specified with **-Domain**.

```
PowerShell Get-Domain  
  
Forest                  : cyberbotic.io  
DomainControllers       : {dc-1.cyberbotic.io}  
Children                : {}  
DomainMode              : Unknown  
DomainModeLevel         : 7  
Parent                  :   
PdcRoleOwner            : dc-1.cyberbotic.io  
RidRoleOwner            : dc-1.cyberbotic.io  
InfrastructureRoleOwner : dc-1.cyberbotic.io  
Name                    : cyberbotic.io
```

### Get-DomainController
Enumerates the domain controllers for the current or specified domain.
```
>  PowerShell Get-DomainController | Select-Object Forest, Name, OSVersion  
  
  
Forest          Name                 OSVersion                     
\------          ----                 ---------                     
cyberbotic.io   dc-1.cyberbotic.io   Windows Server 2016 Standard

```

### Get-ForestDomain
Returns all domains for the current forest or the forest specified by **-Forest** (not particularly interesting in single-domain forests).

```
 > PowerShell Get-ForestDomain  
  
Forest                  : cyberbotic.io  
DomainControllers       : {dc-1.cyberbotic.io}  
Children                : {}  
DomainMode              : Unknown  
DomainModeLevel         : 7  
Parent                  :   
PdcRoleOwner            : dc-1.cyberbotic.io  
RidRoleOwner            : dc-1.cyberbotic.io  
InfrastructureRoleOwner : dc-1.cyberbotic.io  
Name                    : cyberbotic.io
```

### Get-DomainPolicy
Returns the default domain policy or the domain controller policy for the current domain or a specified domain/domain controller. Useful for finding information such as the domain password policy.

```
 > PowerShell Get-DomainPolicy | Select-Object -ExpandProperty SystemAccess  
  
MinimumPasswordAge           : 1  
MaximumPasswordAge           : 42  
MinimumPasswordLength        : 7  
PasswordComplexity           : 1  
PasswordHistorySize          : 24  
LockoutBadCount              : 0  
RequireLogonToChangePassword : 0  
ForceLogoffWhenHourExpire    : 0  
ClearTextPassword            : 0  
LSAAnonymousNameLookup       : 0

```

### Get-DomainUser
Return all users or specific user objects in AD. To only return specific properties, use **-Properties**. By default, all user objects for the current domain are returned, use **-Identity** to return a specific user.
```
 > PowerShell Get-DomainUser -Identity j.hunt -Properties DisplayName, MemberOf | Format-List  
  
displayname : Jordan Hunt  
memberof : {CN=Proxy Users,CN=Users,DC=cyberbotic,DC=io, CN=Roaming Users,CN=Users,DC=cyberbotic,DC=io}
```

### Get-DomainComputer
Return all computers or specific computer objects in AD.

```
 > PowerShell Get-DomainComputer -Properties DnsHostName | Sort-Object -Property DnsHostName
 ```
 
 ### Get-DomainOU
 
 ```
  > PowerShell Get-DomainOU -Properties Name | Sort-Object -Property Name
  ```
  
  ### Get-DomainGroup
  ```
> PowerShell Get-DomainGroup -Identity 'Domain Admins' | Select-Object -ExpandProperty Member  
  
CN=Warren Schneider,CN=Users,DC=cyberbotic,DC=io  
CN=Nicola Glover,CN=Users,DC=cyberbotic,DC=io  
CN=Administrator,CN=Users,DC=cyberbotic,DC=io
```

### Get-DomainGroupMember
Return the members of a specific domain group.
```

> PowerShell Get-DomainGroupMember -Identity 'Domain Admins' | Select-Object MemberDistinguishedName  
  
MemberDistinguishedName   
-----------------------   
CN=Warren Schneider,CN=Users,DC=cyberbotic,DC=io  
CN=Nicola Glover,CN=Users,DC=cyberbotic,DC=io   
CN=Administrator,CN=Users,DC=cyberbotic,DC=io
```

### Get-DomainGPO
Return all Group Policy Objects (GPOs) or specific GPO objects in AD. To enumerate all GPOs that are applied to a particular machine, use **-ComputerIdentity**.

```
> PowerShell Get-DomainGPO -Properties DisplayName | Sort-Object -Property DisplayName  
  
displayname                        
-----------                        
Default Domain Controllers Policy  
Default Domain Policy              
Folder Redirection                 
Helpdesk Admins                    
Internet Settings                  
LAPS                               
Logon Restrictions                 
Oracle Admins                      
Server Baseline                    
Workstation Admins                 
Workstation Baseline

> PowerShell Get-DomainGPO -ComputerIdentity wkstn-1555 -Properties DisplayName | Sort-Object -Property DisplayName  
  
displayname            
-----------            
Default Domain Policy  
Folder Redirection     
Internet Settings      
Logon Restrictions     
Workstation Baseline
```

### Find-DomainUserLocation
Enumerates all machines on the current (or specified) domain and queries the domain for users of a specified group (default Domain Admins). Then finds domain machines where specific users are logged into.
```
> PowerShell Find-DomainUserLocation | Select-Object UserName,SessionFromName  
  
UserName    SessionFromName           
--------    ---------------           
w.schneider wkstn-6099.cyberbotic.io
```

### Get-NetLocalGroup
```
> PowerShell Get-NetLocalGroup | Select-Object GroupName  
  
GroupName   
---------   
Access Control Assistance Operators  
Administrators   
Backup Operators   
Cryptographic Operators   
Distributed COM Users   
Event Log Readers   
Guests   
Hyper-V Administrators   
IIS\_IUSRS   
Network Configuration Operators   
Performance Log Users   
Performance Monitor Users   
Power Users   
Remote Desktop Users   
Remote Management Users   
Replicator   
System Managed Accounts Group   
Users
```

### Get-NetLoggedOn
Returns users logged on the local (or a remote) machine. Local admin rights are required on the remote machine.

```
> PowerShell Get-NetLoggedOn  
  
UserName     : n.lamb  
LogonDomain  : CYBER  
AuthDomains  :   
LogonServer  : DC-1  
ComputerName : localhost  
  
UserName     : j.hunt  
LogonDomain  : CYBER  
AuthDomains  :   
LogonServer  : DC-1  
ComputerName : localhost
```

### Get-NetSession
Returns session information for the local (or a remote) machine, where **CName** is the source IP.
```
> PowerShell Get-NetSession -ComputerName fs-1 | Select-Object CName, UserName  
  
CName           UserName    
-----           --------    
\\10.10.121.118 t.cobb      
\\10.10.121.119 s.owen      
\\10.10.121.111 s.ball      
\\10.10.121.107 p.burke     
\\10.10.121.108 t.patrick   
\\10.10.121.110 n.lamb      
\\10.10.121.106 j.hunt      
\\10.10.121.115 s.bowers    
\\10.10.121.109 d.greer     
\\10.10.121.112 r.mckenzie  
\\10.10.121.113 p.morgan    
\\10.10.121.116 r.meyer
```

### Get-DomainTrust
Return all domain trusts for the current domain or a specified domain.
```
> PowerShell Get-DomainTrust  
  
SourceName      : cyberbotic.io  
TargetName      : dev.zeropointsecurity.co.uk  
TrustType       : WINDOWS\_ACTIVE\_DIRECTORY  
TrustAttributes :   
TrustDirection  : Inbound  
WhenCreated     : 18/03/2020 15:30:41  
WhenChanged     : 18/03/2020 15:30:41
```